"use strict"; /* istanbul ignore next */var cov_aa8p1u7zn = function () {var path = "/code/cilantro/iogates-transfer/src/lib/iogates.ts",hash = "69f38987ab1f85f1b0c5dcf8f2d4d355bfe3935a",global = new Function('return this')(),gcv = "__coverage__",coverageData = { path: "/code/cilantro/iogates-transfer/src/lib/iogates.ts", statementMap: { "0": { start: { line: 2, column: 0 }, end: { line: 2, column: 62 } }, "1": { start: { line: 3, column: 16 }, end: { line: 3, column: 34 } }, "2": { start: { line: 4, column: 16 }, end: { line: 4, column: 32 } }, "3": { start: { line: 5, column: 12 }, end: { line: 5, column: 45 } }, "4": { start: { line: 11, column: 8 }, end: { line: 11, column: 73 } }, "5": { start: { line: 12, column: 8 }, end: { line: 12, column: 24 } }, "6": { start: { line: 15, column: 8 }, end: { line: 15, column: 42 } }, "7": { start: { line: 16, column: 8 }, end: { line: 31, column: 11 } }, "8": { start: { line: 17, column: 12 }, end: { line: 30, column: 15 } }, "9": { start: { line: 23, column: 16 }, end: { line: 25, column: 17 } }, "10": { start: { line: 24, column: 20 }, end: { line: 24, column: 39 } }, "11": { start: { line: 26, column: 16 }, end: { line: 26, column: 52 } }, "12": { start: { line: 27, column: 16 }, end: { line: 27, column: 40 } }, "13": { start: { line: 28, column: 16 }, end: { line: 28, column: 41 } }, "14": { start: { line: 29, column: 16 }, end: { line: 29, column: 38 } }, "15": { start: { line: 34, column: 8 }, end: { line: 34, column: 32 } }, "16": { start: { line: 35, column: 8 }, end: { line: 45, column: 11 } }, "17": { start: { line: 36, column: 12 }, end: { line: 44, column: 15 } }, "18": { start: { line: 40, column: 16 }, end: { line: 42, column: 17 } }, "19": { start: { line: 41, column: 20 }, end: { line: 41, column: 39 } }, "20": { start: { line: 43, column: 16 }, end: { line: 43, column: 41 } }, "21": { start: { line: 48, column: 24 }, end: { line: 53, column: 9 } }, "22": { start: { line: 54, column: 8 }, end: { line: 56, column: 9 } }, "23": { start: { line: 55, column: 12 }, end: { line: 55, column: 47 } }, "24": { start: { line: 57, column: 8 }, end: { line: 57, column: 41 } }, "25": { start: { line: 60, column: 0 }, end: { line: 60, column: 26 } } }, fnMap: { "0": { name: "(anonymous_0)", decl: { start: { line: 10, column: 4 }, end: { line: 10, column: 5 } }, loc: { start: { line: 10, column: 18 }, end: { line: 13, column: 5 } }, line: 10 }, "1": { name: "(anonymous_1)", decl: { start: { line: 14, column: 4 }, end: { line: 14, column: 5 } }, loc: { start: { line: 14, column: 31 }, end: { line: 32, column: 5 } }, line: 14 }, "2": { name: "(anonymous_2)", decl: { start: { line: 16, column: 27 }, end: { line: 16, column: 28 } }, loc: { start: { line: 16, column: 48 }, end: { line: 31, column: 9 } }, line: 16 }, "3": { name: "(anonymous_3)", decl: { start: { line: 22, column: 15 }, end: { line: 22, column: 16 } }, loc: { start: { line: 22, column: 33 }, end: { line: 30, column: 13 } }, line: 22 }, "4": { name: "(anonymous_4)", decl: { start: { line: 33, column: 4 }, end: { line: 33, column: 5 } }, loc: { start: { line: 33, column: 16 }, end: { line: 46, column: 5 } }, line: 33 }, "5": { name: "(anonymous_5)", decl: { start: { line: 35, column: 27 }, end: { line: 35, column: 28 } }, loc: { start: { line: 35, column: 48 }, end: { line: 45, column: 9 } }, line: 35 }, "6": { name: "(anonymous_6)", decl: { start: { line: 39, column: 15 }, end: { line: 39, column: 16 } }, loc: { start: { line: 39, column: 37 }, end: { line: 44, column: 13 } }, line: 39 }, "7": { name: "(anonymous_7)", decl: { start: { line: 47, column: 4 }, end: { line: 47, column: 5 } }, loc: { start: { line: 47, column: 17 }, end: { line: 58, column: 5 } }, line: 47 } }, branchMap: { "0": { loc: { start: { line: 23, column: 16 }, end: { line: 25, column: 17 } }, type: "if", locations: [{ start: { line: 23, column: 16 }, end: { line: 25, column: 17 } }, { start: { line: 23, column: 16 }, end: { line: 25, column: 17 } }], line: 23 }, "1": { loc: { start: { line: 40, column: 16 }, end: { line: 42, column: 17 } }, type: "if", locations: [{ start: { line: 40, column: 16 }, end: { line: 42, column: 17 } }, { start: { line: 40, column: 16 }, end: { line: 42, column: 17 } }], line: 40 }, "2": { loc: { start: { line: 54, column: 8 }, end: { line: 56, column: 9 } }, type: "if", locations: [{ start: { line: 54, column: 8 }, end: { line: 56, column: 9 } }, { start: { line: 54, column: 8 }, end: { line: 56, column: 9 } }], line: 54 } }, s: { "0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "12": 0, "13": 0, "14": 0, "15": 0, "16": 0, "17": 0, "18": 0, "19": 0, "20": 0, "21": 0, "22": 0, "23": 0, "24": 0, "25": 0 }, f: { "0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0 }, b: { "0": [0, 0], "1": [0, 0], "2": [0, 0] }, _coverageSchema: "332fd63041d2c1bcb487cc26dd0d5f7d97098a6c" },coverage = global[gcv] || (global[gcv] = {});if (coverage[path] && coverage[path].hash === hash) {return coverage[path];}coverageData.hash = hash;return coverage[path] = coverageData;}();++cov_aa8p1u7zn.s[0];
Object.defineProperty(exports, "__esModule", { value: true });
const request = /* istanbul ignore next */(++cov_aa8p1u7zn.s[1], require("request"));
const debug_1 = /* istanbul ignore next */(++cov_aa8p1u7zn.s[2], require("debug"));
const log = /* istanbul ignore next */(++cov_aa8p1u7zn.s[3], debug_1.default('io:lib:iogates'));
/**
                                                                                                  * API wrapper class for IOGates
                                                                                                  */
class IOGates {
    constructor() {/* istanbul ignore next */++cov_aa8p1u7zn.f[0];++cov_aa8p1u7zn.s[4];
        this.baseUrl = 'https://share-web02-transferapp.iogates.com/api'; /* istanbul ignore next */++cov_aa8p1u7zn.s[5];
        this.token = '';
    }
    authenticateFromUrl(share) {/* istanbul ignore next */++cov_aa8p1u7zn.f[1];++cov_aa8p1u7zn.s[6];
        log('called authenticateFromUrl'); /* istanbul ignore next */++cov_aa8p1u7zn.s[7];
        return new Promise((resolve, reject) => {/* istanbul ignore next */++cov_aa8p1u7zn.f[2];++cov_aa8p1u7zn.s[8];
            this.getRequest().post({
                url: '/authtoken',
                json: {
                    url: share.url } },

            (err, r, data) => {/* istanbul ignore next */++cov_aa8p1u7zn.f[3];++cov_aa8p1u7zn.s[9];
                if (r.statusCode !== 200) {/* istanbul ignore next */++cov_aa8p1u7zn.b[0][0];++cov_aa8p1u7zn.s[10];
                    return reject(err);
                } else /* istanbul ignore next */{++cov_aa8p1u7zn.b[0][1];}++cov_aa8p1u7zn.s[11];
                log('received token: ', data.token); /* istanbul ignore next */++cov_aa8p1u7zn.s[12];
                this.token = data.token; /* istanbul ignore next */++cov_aa8p1u7zn.s[13];
                share.token = data.token; /* istanbul ignore next */++cov_aa8p1u7zn.s[14];
                return resolve(share);
            });
        });
    }
    readFiles() {/* istanbul ignore next */++cov_aa8p1u7zn.f[4];++cov_aa8p1u7zn.s[15];
        log('called readFiles'); /* istanbul ignore next */++cov_aa8p1u7zn.s[16];
        return new Promise((resolve, reject) => {/* istanbul ignore next */++cov_aa8p1u7zn.f[5];++cov_aa8p1u7zn.s[17];
            this.getRequest().get({
                url: '/files',
                json: true },
            (err, r, response) => {/* istanbul ignore next */++cov_aa8p1u7zn.f[6];++cov_aa8p1u7zn.s[18];
                if (r.statusCode !== 200) {/* istanbul ignore next */++cov_aa8p1u7zn.b[1][0];++cov_aa8p1u7zn.s[19];
                    return reject(err);
                } else /* istanbul ignore next */{++cov_aa8p1u7zn.b[1][1];}++cov_aa8p1u7zn.s[20];
                return resolve(response);
            });
        });
    }
    getRequest() {/* istanbul ignore next */++cov_aa8p1u7zn.f[7];
        const options = /* istanbul ignore next */(++cov_aa8p1u7zn.s[21], {
            baseUrl: this.baseUrl,
            headers: {
                token: '' } }); /* istanbul ignore next */++cov_aa8p1u7zn.s[22];


        if (this.token.length > 0) {/* istanbul ignore next */++cov_aa8p1u7zn.b[2][0];++cov_aa8p1u7zn.s[23];
            options.headers.token = this.token;
        } else /* istanbul ignore next */{++cov_aa8p1u7zn.b[2][1];}++cov_aa8p1u7zn.s[24];
        return request.defaults(options);
    }} /* istanbul ignore next */++cov_aa8p1u7zn.s[25];

exports.IOGates = IOGates;
//# sourceMappingURL=iogates.js.map